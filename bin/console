#!/usr/bin/env php
<?php

$root = dirname(__DIR__);

require "{$root}/vendor/autoload.php";

$process = new \App\Process();

$parameters = [
    'processes_count' => 2,
    'interval_count' => 40000000
];

$task = function ($parameters) {
    $order = $parameters['order']; // номер процесса 
    $size = $parameters['processes_count']; // кол-во процессов всего 
    $n = $parameters['interval_count']; // кол-во интервалов

    $h = 1 / $n;
    $sum = 0;

    for ($i = $order + 1; $i <= $n; $i += $size) {
        $x = $h * ($i - 0.5);
        $sum += (4.0 / (1.0 + $x * $x));
    }

    $pi = $h * $sum;
};

$task = \App\Process::bindParameters($task, $parameters);

$process->addTask($task, $parameters['processes_count']);

$process->start();